# Решение

пробуем ввести рандомный пароль, смотрим на реакцию. 
обнаруживаем hash mismatch, а также в консоли
```
App.js:30 AssertionError: Hash mismatch:
  expected = 3c13d6be6015574cfdb1b7b16bd56bfc1e23311d
  actual   = c9319df00540edb31be6abf356735d0337e3f475
```

Из сообщения об ошибке можно понять, что `expected` это хеш пароля пользователя, а `actual` это хеш введённого пароля.  
С помощью идентификатора хешей (например, [этого сервиса](https://hashes.com/en/tools/hash_identifier)) определяем, что для хеширования используется алгоритм SHA-1.  
Но при этом SHA-1 хеш от введённого пароля не совпадает с `actual`, что указывает на использование соли при хешировании.

Так как известен введённый пароль, можно попытаться подобрать соль перебором.  
Для этого используем **hashcat** в режиме комбинирования словарей. В качестве первого словаря указываем файл с паролем, а в качестве второго словарь `rockyou.txt`.

Команда для перебора соли:
```bash
hashcat -m 100 -a 1 \
  hash.txt \
  pass.txt \
  rockyou.txt
```

Где:
- `-m 100` — режим SHA-1
- `-a 1` — комбинированный режим (wordlist1 + wordlist2)
- `hash.txt` — файл с хешем, полученным из `actual`
- `pass.txt` — файл с известным паролем
- `rockyou.txt` — словарь для подбора соли

В результате перебора получаем соль — `takuya`.  
Теперь, зная соль, можно подобрать пароль пользователя, хеш которого указан в поле `expected`.

Команда для подбора пароля:
```bash
hashcat -m 100 -a 1 \
  hash.txt \
  rockyou.txt \
  salt.txt
```

Где `salt.txt` — файл, содержащий найденную соль (`takuya`).

в результате перебора паролей получаем пароль 'aquarium'

пробуем войти с полученным паролем, но обнаруживаем ещё одну ошибку: 
```
Salt header required!
You need to send x-hash-salt header with correct value
```

чтож, запускаем Burp Suite, перехватываем запрос, и варварски дописываем ему заголовок, положив в него ранее полученную соль

```
...
x-hash-salt: takuya
...
```

после чего нас пускает на "форум", где не так трудно найти флаг:
newyearctf{h4ppy_n3w_y3ar_fr0m_2000s_forum}

